{% extends 'base.html' %}
{% block content %}
    <h1>Login</h1>
    <form id="login-form">
        <label>
            Account name:
            <input id="account_name" type="text" required>
        </label>
        <br>
        <label>
            Password:
            <input id="password" type="password" required>
        </label>
        <br>
        <button type="submit">Log in</button>
    </form>

    <script>
        const form = document.getElementById("login-form")

        form.addEventListener('submit', (e) => {
            e.preventDefault();

            const accountName = document.getElementById("account_name").value
            const password = document.getElementById("password").value

            fetch('http://127.0.0.1:8000/api/v1/auth/sign-in/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    account_name: accountName,
                    password: password,
                }),
            }).then(async response => {
                if (response.ok) {
                    document.location.href='/admin/'
                }
            })
        })
    </script>
{% endblock %}